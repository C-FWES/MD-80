<?xml version="1.0"?>

<!-- McDonnell Douglas MD-80 Warning Computations -->
<!-- Copyright (c) 2021 Jonathan Redpath -->

<system name="MD-80: Warnings">
	
	<channel name="Gear Warning" execrate="8">
		
		<switch name="warnings/gear-horn/gear-horn-cmd">
			<default value="0"/>
			<test logic="AND" value="1">
				fcs/flap-pos-deg ge 26
				<test logic="OR">
					/gear/gear[0]/position-norm ne 1
					/gear/gear[1]/position-norm ne 1
					/gear/gear[2]/position-norm ne 1
				</test>
			</test>
			<test logic="AND" value="1">
				/fdm/jsbsim/engine/throttle-compare-max lt 0.01
				/instrumentation/airspeed-indicator/indicated-speed-kt lt 210
				/position/gear-agl-ft lt 1500
				<test logic="OR">
					/gear/gear[0]/position-norm ne 1
					/gear/gear[1]/position-norm ne 1
					/gear/gear[2]/position-norm ne 1
				</test>
			</test>
		</switch>
	
		<switch name="warnings/gear-horn/gear-horn-inhibit">
			<default value="0"/>
			<test logic="AND" value="1"> <!-- keep inhibit until the throttles are reset or flaps > 26 -->
				fcs/flap-pos-deg lt 26
				warnings/gear-horn/gear-horn-inhibit eq 1
				/fdm/jsbsim/engine/throttle-compare-max lt 0.01
			</test>
			<test logic="AND" value="1"> <!-- only allow inhibit if flaps less than 26 -->
				fcs/flap-pos-deg lt 26
				warnings/gear-horn/gear-horn eq 1
				warnings/gear-horn/gear-horn-inhibit-cmd eq 1
			</test>
		</switch>
		
		<switch name="warnings/gear-horn/gear-horn">
			<default value="0"/>
			<test logic="AND" value="1">
				warnings/gear-horn/gear-horn-cmd eq 1
				warnings/gear-horn/gear-horn-inhibit eq 0
			</test>
		</switch>
	</channel>

</system>
